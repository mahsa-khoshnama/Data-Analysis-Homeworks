---
title: "Fifth Week: Bootstrap and Resampling Methods"
subtitle: "Nonparametric Hypothesis tests"
author: "مهسا خوش نما 93101481"
date: "`r Sys.time()`"
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = F, warning = F, error = F,fig.width = 16,fig.height = 8)
```
<div align="center">
<img  src="images/NonparametricStatistics_iStock.jpg"  align = 'center'>
</div>

> <p dir="RTL"> 
لطفا با سوالات زیر پاسخ دهید.
در همه سوالات سطح دقت را ۹۵ درصد در نظر بگیرید.
</p>

```{r}
library(coin)
library(readr)
```


***

<p dir="RTL">
۱. شرکتی میخواهد تحقیق کند آیا درآمد نمایندگی های آن یکسان است. برای بررسی این موضوع هشت نمایندگی
به طور تصادفی انتخاب شده اند که به ترتیب میزان فروش آنها عبارت است از 
102, 300, 102, 100, 205, 105, 71 , 92.
با توجه به داده آیا عملکرد نمایندگی ها یکسان است؟
</p>

<h3 dir = "RTL">
پاسخ:
</h3>

<p dir="RTL">
از آزمون فرض chi-squared با توزیع یکنواخت استفاده می کنیم.
</p>

```{r}
prob = rep(1/8,8)
chisq.test(c(102, 300, 102, 100, 205, 105, 71 , 92), p = prob)
```

<p dir="RTL">
با توجه به این که p-value بسیار کوچک و کمتر از 0.05 است، فرض صفر رد می شود یعنی فروش نمایندگی های مختلف یکسان نبوده است.
</p>
***

<p dir="RTL">
۲. آمار فروش شرکتی در دو نوع شعبه سنتی و مدرن در زیر آمده است:
</p>

Classical stores: 50, 50, 60, 70, 75, 80, 90, 85

Modern stores: 55, 75, 80, 90, 105, 65

<p dir="RTL">
آیا تفاوتی در عملکرد دو نوع شعبه وجود دارد؟
</p>

<h3 dir = "RTL">
پاسخ:
</h3>

<p dir="RTL">
از permutation test برای بررسی تفاوت میانگین فروش دو شعبه استفاده می کنیم.
</p>

```{r}
mydata = data.frame(score = c(50, 50, 60, 70, 75, 80, 90, 85,55, 75, 80, 90, 105, 65),
                    treatment = factor(c(rep("classical",8), rep("modern",6))))
coin::oneway_test(score~treatment, data=mydata, distribution="exact")
```

<p dir="RTL">
با توجه به این که مقدار p-value significant نیست، نمی توان فرض صفر را رد کرد و درواقع نمی توان گفت که تفاوت معناداری بین عملکرد دو نوع شعبه وجود دارد.
</p>

***

<p dir="RTL">
۳. اطلاعات حسابداری ۱۵ شعبه که به صورت تصادفی انتخاب شده اند به شرح زیر است:
</p>

509, 517, 502, 629, 830, 911, 847, 803, 727, 853, 757, 730, 774, 718, 904

<p dir="RTL">
شرکت مذکور برای ارتقای فروش خود یک طرح تبلیغاتی جدید را اجرا میکند. پس از طرح جدید نتایج عملکرد شعبه ها  به صورت زیر 
اندازه گیری شده است
</p>

517, 508, 523, 730, 821, 940, 818, 821, 842, 842, 709, 688, 787, 780, 901

<p dir="RTL">
آیا تبلیغات جدید عملکرد فروش را بالا برده است؟
</p>

<h3 dir = "RTL">
پاسخ:
</h3>

<p dir="RTL">
برای بررسی تغییرات پس از تبلیغات از wilcoxon rank sum test به صورت paired و یک طرفه استفاده می کنیم.
</p>

```{r}
wilcox.test(c(509, 517, 502, 629, 830, 911, 847, 803, 727, 853, 757, 730, 774, 718, 904),
            c(517, 508, 523, 730, 821, 940, 818, 821, 842, 842, 709, 688, 787, 780, 901),
            alternative = "less", paired = T)
```

<p dir="RTL">
با توجه به این که مقدار p-value significant نیست، فرض صفر را نمی توان رد کرد یعنی نمی توان گفت که تبلیغات اثر مثبت داشته(که این گزاره فرض 1 است).
</p>


***

<p dir="RTL">
۴. محصولی در سه رنگ سفید آبی و قرمز تولید شده است.
پنج شعبه ار فروشگاه سازنده محصول به صورت تصادفی انتخاب شده و اطلاعات فروش آنها در زیر آمده است.
</p>

| Store | White | Blue | Red |
| :----: | :----: | :----: | :----: |
| 1. |	510 |	925 |	730 |
| 2. | 720 | 735 | 745 |
| 3. |	930 |	753 |	875 |
| 4. |	754 |	685 |	610 |
| 5. |	105	|  |  |

<p dir="RTL">
با توجه به داده های بالا آیا رنگی خاص در میزان فروش محصولات تاثیر دارد؟
</p>

<h3 dir = "RTL">
پاسخ:
</h3>

<p dir="RTL">
از آزمون فرض kruskal برای بررسی تفاوت بین سه رنگ محصول استفاده می کنیم.
</p>

```{r}
mydata = data.frame(score = c(510, 925,	730,
                720, 735,	745,
                930, 753,	875,
                754, 685,	610,
                105), color = factor(c(rep(c("w","b","r"),4),"w")))
kruskal.test(score~color,data=mydata)
```

<p dir="RTL">
با توجه به این که مقدار p-value significant نیست، نمی توان گفت که رنگ محصول تفاوت معناداری در میزان فروش ایجاد می کند.
</p>
***

<p dir="RTL">
۵. یک موسسه نظرسنجی نظرات مردم در مورد رضایت از یک محصول که در ماه های فروردین اردیبهشت خرداد و تیر که از طریق تلویزیون 
تبلیغ شده است را مورد ارزیابی قرار می دهد.این کار بدین صورت است از افرادی در ماه اول سوال پرسیده می شود و در ماه آینده نیز از همان فرد سوال می شود که آیا از محصول مذکور راضی هستی یا خیر.
با توجه به داده ایی که در پیوست تمرین آمده است آیا تبلیغات تاثیر مثبتی در افزایش رضایت مردم داشته است؟
</p>

<h3 dir = "RTL">
پاسخ:
</h3>

<p dir="RTL">
برای بررسی تفاوت بین میزان رضایت در ماه های مختلف از Friedman test استفاده می کنیم. هم چنین برای بررسی افزایش رضایت ماه چهارم نسبت به ماه اول از wilcoxon test به صورت paired و یک طرفه استفاده می کنیم.
</p>

```{r}
data = read_csv("F:/University/8th Semester/Data Analysis/HWs/hw_05/hw_05/data/tv.csv")
as.matrix(data) -> data
friedman.test(data)
```

<p dir="RTL">
با توجه به این که مقدار p-value significant نیست، نمی توان گفت که تفاوت معناداری بین رضایت مشتریان  در ماه های مختلف وجود دارد.
</p>

```{r}
wilcox.test(data[,1],data[,4], paired = T, alternative = "less")
```

<p dir="RTL">
هم چنین نمی توان گفت مه رضایت در ماه آخر نسبت به ماه اول افزایش پیدا کرده است.
</p>
***

<p dir="RTL"> 
۶. شرکتی در حال تحقیق بر روی این موضوع است که آیا جمعیت شهر تاثیری در نوع میزان مصرف محصولات شرکت دارد.
با توجه به داده زیر این موضوع را تحقیق کنید؟
</p>


| City size |	| Frequency of service usage | |
| :---: |  :---:  | :---: | :---: | 
| | Always	| Sometime | Never |
| Small	| 151	| 252	| 603 |
| Medium	| 802	| 603	| 405 |
| Large	| 753	| 55	| 408 |


<h3 dir = "RTL">
پاسخ:
</h3>

<p dir="RTL">
برای بررسی تاثیر جمعیت شهر بر میزان مصرف محصولات از chi-squared test استفاده می کنیم.
</p>

```{r}
data = matrix(c(151, 252,	603,
              	802, 603,	405,
              	753, 55,	408), byrow = T, nrow =3)
chisq.test(data)
```

<p dir="RTL">
با توجه به این که مقدار p-value کوچک و کمتر از 0.05 است، فرض صفر رد می شود یعنی جمعیت شهر بر میزان فروش تاثیر گذار است و میزان فروش مستقل از جمعیت شهر نیست.
</p>

***

<p dir="RTL"> 
۷. شرکتی انتظار دارد با ارایه محصول الف میزان فروش محصول ب افزایش یابد.
به همین منظور به طور تصادفی از صد مشتری خود اطلاعات مصرف جمع آوری می نماید.
با توجه به داده های که داده شده آیا ربط معناداری بین فروش این دو محصول وجود دارد؟
</p>

<h3 dir = "RTL">
پاسخ:
</h3>

<p dir="RTL">
برای بررسی تاثیر فروش محصول A روی فروش محصول B از correlation test با روش spearman استفاده می کنیم.
</p>

```{r}
data = read_csv("F:/University/8th Semester/Data Analysis/HWs/hw_05/hw_05/data/consumption.csv")
cor.test(data$A,data$B, method = "spearman")
```

<p dir="RTL">
با توجه به این که مقدار p-value significant نیست، فرض صفر رد نمی شود یعنی نمی توان گفت که فروش محصول A تاثیر معناداری روی فروش محصول B داشته است.
</p>
***

<p dir="RTL"> 
۸. یک شرکت از ۲۰۰۰ نفر از مشتریان خود عامل خرید محصول را مورد سوال قرار میدهد 
که خلاصه اطلاعات آن را در زیر می توانید مشاهده کنید
</p>

| Characteristics	| Male	| Female |
| :---: |  :---:  | :---: |
| Price	| 301	| 502 |
| Design	| 353	| 155 |
| Color	| 558	| 153 |

<p dir="RTL"> 
آیا جنسیت تاثیری در مشخصه کاربری کالا دارد؟
</p>


<h3 dir = "RTL">
پاسخ:
</h3>

<p dir="RTL">
برای بررسی تاثیر جنسیت از chi-squared test استفاده می کنیم.
</p>

```{r}
data = matrix(c(301,	502,
                353,	155,
                558,	153),  byrow = T, nrow = 3)
chisq.test(data)
```

<p dir="RTL">
با توجه به مقدار بسیار کوچک p-value فرض صفر رد می شود و این یعنی جنسیت و مشخصه ی کاربری کالا از هم مستقل نیستند و جنسیت روی مشخصه کاربری کالا تاثیر دارد.
</p>
